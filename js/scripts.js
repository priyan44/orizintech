import Swiper from"./modules/Swiper.js";import Menu from"./modules/Menu.js";import Modal from"./modules/Modal.js";import Validation from"./modules/Validation.js";import WheelIndicator from"./modules/WheelIndicator.js";const preloader=document.querySelector(".preloader");window.addEventListener("load",()=>{setTimeout(()=>{let e=document.querySelector("meta[name=viewport]");e.setAttribute("content",e.content+", height="+window.innerHeight),preloader.classList.remove("active")},1e3)});const menuController=document.querySelector(".menu-controller"),menu=new Menu(document.querySelector(".menu"));menuController.addEventListener("click",()=>{menuController.classList.toggle("active"),floatingLogo.classList.toggle("active"),menu.isOpen?menu.close():menu.open()});const navLinks=document.querySelectorAll(".nav-link");navLinks.forEach(e=>{e.addEventListener("click",()=>{swiperFreeze||(swiperFreeze=!0,pagesSwiper.slideTo(+e.dataset.target,1e3,!0),setTimeout(()=>{swiperFreeze=!1},1e3)),menuController.classList.remove("active"),floatingLogo.classList.remove("active"),menu.isOpen&&menu.close()})});let swiperFreeze=!1;const floatingElements=document.querySelectorAll(".floating-elements > *"),floatingNav=document.querySelector(".floating-nav"),floatingLogo=document.querySelector(".floating-logo"),floatingContacts=document.querySelector(".floating-contacts"),footer=document.querySelector(".footer"),pages=document.querySelectorAll(".page"),wheelIndicator=new WheelIndicator({elem:document.querySelector(".main-content"),callback:e=>{swiperFreeze||(swiperFreeze=!0,"up"===e.direction?pagesSwiper.slidePrev(1e3):pagesSwiper.slideNext(1e3),setTimeout(()=>{swiperFreeze=!1},1e3))}}),pagesSwiper=new Swiper(".main-content",{direction:"vertical",slidesPerView:1,mousewheel:!1,speed:1e3,slideActiveClass:"active",pagination:{el:".floating-nav",clickable:!0,bulletClass:"floating-nav_item",bulletActiveClass:"active",renderBullet:function(e,t){return`\n                    <div class="${t}">\n                        <div class="floating-nav_item_marker"></div>\n                        <div class="floating-nav_item_title">${pages[e].dataset.title}</div>\n                    </div>\n                `}},on:{slideChange:function(e){pages[e.activeIndex].classList.contains("dark")?floatingElements.forEach(e=>{e.classList.remove("dark"),e.classList.add("light")}):floatingElements.forEach(e=>{e.classList.remove("light"),e.classList.add("dark")})},reachBeginning:function(){floatingNav.classList.remove("active")},reachEnd:function(){floatingContacts.classList.remove("active"),footer.classList.add("active")},fromEdge:function(){floatingNav.classList.add("active"),floatingContacts.classList.add("active"),footer.classList.remove("active")}}}),projectsContainer=document.querySelector(".projects_slider"),projectsPagination=document.querySelector(".projects_pagination"),projectsPaginationFill=document.querySelector(".projects_pagination_fill"),projects=new Swiper(".projects_slider",{slidesPerView:window.innerWidth>768?2.25:1.1,spaceBetween:10,freeMode:window.innerWidth>768,grabCursor:!0,pagination:{el:".projects_pagination",type:"progressbar",progressbarFillClass:"projects_pagination_fill"},on:{reachBeginning:function(){projectsContainer.classList.add("beginning")},reachEnd:function(){projectsContainer.classList.add("end")},fromEdge:function(){projectsContainer.classList.remove("beginning"),projectsContainer.classList.remove("end")}}});projectsPagination.addEventListener("click",e=>{projectsPaginationFill.style.transform=`translate3d(0px, 0px, 0px) scaleX(${e.offsetX/projectsPagination.offsetWidth}) scaleY(1)`,projects.translateTo(-e.offsetX/projectsPagination.offsetWidth*projects.virtualSize,500,!0,!0)});const intro=document.querySelector(".intro"),introEye=document.querySelector(".intro_eye"),introEyeDemensions=introEye.getBoundingClientRect();intro.addEventListener("mousemove",e=>{introEye.classList.add("active")});const contactsForm=document.querySelector(".contacts_form"),contactstFromTextInputs=contactsForm.querySelectorAll(".form_text_item"),contactsFormCheckbox=contactsForm.querySelector(".form_check_item input"),modalElement=document.querySelector(".success-modal"),modal=new Modal(modalElement);contactstFromTextInputs.forEach(e=>{const t=e.querySelector(".form_item_input"),o=e.querySelector(".form_item_placeholder");t.addEventListener("focus",()=>{o.classList.add("active"),window.innerWidth<=480&&(footer.classList.remove("active"),floatingNav.classList.remove("active"))}),t.addEventListener("blur",()=>{""==t.value&&(o.classList.remove("active"),window.innerWidth<=480&&(footer.classList.add("active"),floatingNav.classList.add("active")))})}),contactsFormCheckbox.addEventListener("change",()=>{contactsFormCheckbox.checked?contactsForm.classList.remove("disabled"):contactsForm.classList.add("disabled")}),contactsForm.addEventListener("submit",e=>{if(!contactsForm.classList.contains("disabled")){e.preventDefault();const t=new Validation;['input[type="text"]',"textarea"].forEach(e=>{contactsForm.querySelectorAll(e).forEach(e=>{t.validate(e,["required"])})}),t.errors.length>0?(t.fields.forEach(e=>{e.closest(".form_item").classList.remove("invalid")}),t.errors.forEach(e=>{e.field.closest(".form_item").classList.add("invalid")})):(t.fields.forEach(e=>{e.closest(".form_item").classList.remove("invalid")}),fetch("/server/sendmail.php",{method:"POST",body:new FormData(contactsForm)}).then(e=>e.json()).then(e=>{switch(contactsForm.reset(),contactsForm.querySelectorAll(".form_item_placeholder").forEach(e=>{e.classList.remove("active")}),e.status){case"success":modal.open(),modalElement.addEventListener("click",()=>{modal.close()}),setTimeout(()=>{modal.close()},2e3);break;case"fail":console.log("fail")}}))}});